!function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/",i(i.s=486)}({124:function(t,e,i){"use strict";i.d(e,"a",function(){return n});var n=function(t){return window.tinymce.settings.plugins.includes(t)}},486:function(t,e,i){"use strict";i.r(e);var n=function(t){return void 0===t&&(t=""),t.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},r=function(t,e,i,n,r){void 0===n&&(n=null);var o=function(t,e){void 0===e&&(e=860);var i={width:0,height:0};if(""!==t&&(t.split("?")[1].split("&").reduce(function(t,e){var i=e.split("=");return t[i[0]]=i[1],t},i),i.width>e)){var n=i.height/i.width;i.width=e,i.height=Math.round(i.width*n)}return i}(t.image&&t.image.length>0?t.image[0]:"",n);if(e.setAttribute("data-ke-type","video"),e.setAttribute("data-ke-mobilestyle","widthContent"),e.setAttribute("data-ke-style","alignCenter"),e.setAttribute("data-video-host",i),e.setAttribute("data-video-url",t.url),e.setAttribute("data-video-thumbnail",t.image),e.setAttribute("data-source-url",t.source_url),e.setAttribute("data-video-width",o.width),e.setAttribute("data-video-height",o.height),e.setAttribute("data-video-origin-width",o.width),e.setAttribute("data-video-origin-height",o.height),t.title&&e.setAttribute("data-video-title",t.title),r&&"kakaotv"==i&&e.setAttribute("data-video-play-service",r),"twitch"===i){var a=t.source_url.includes("clip");e.setAttribute("data-is-twitch-clips",a)}return'<div class="video_content">\n            <img width='+o.width+" height="+o.height+' src="'+t.image+'"/>\n            <div class="video_title">'+("kakaotv"===i&&t.title||"")+"</div>\n          </div>"},o=function(t,e){return e.setAttribute("data-ke-type","opengraph"),e.setAttribute("data-ke-align","alignCenter"),e.setAttribute("data-og-type",t.type),e.setAttribute("data-og-title",t.title),e.setAttribute("data-og-description",t.description),e.setAttribute("data-og-host",t.host),e.setAttribute("data-og-source-url",t.source_url),e.setAttribute("data-og-url",t.url),e.setAttribute("data-og-image",t.image),' \n    <a href="'+t.requested_url+'" target="_blank" data-source-url="'+t.source_url+'">\n      <div class="og-image" style="background-image:url('+t.image+')"></div>\n      <div class="og-text">\n        <p class="og-title">'+n(t.title)+'</p>\n        <p class="og-desc">'+n(t.description)+'</p>\n        <p class="og-host">'+t.host+"</p>\n      </div>\n    </a>\n  "},a=function(t,e,i,n,a){var s;i.id="og_"+Date.now();var u=t.getBody().offsetWidth,d=u;t.settings.autoresize_overflow_padding&&(u-=2*t.settings.autoresize_overflow_padding);var g=t.settings.kOpengraph.filters||[],l=function(t){if(!t.type.startsWith("video"))return"";switch(!0){case/^(sandbox\-)|^(beta\-)?tv.kakao.com/.test(t.host):return"kakaotv";case/vimeo.com/.test(t.host):return"vimeo";case/www.youtube.com|youtu.be/.test(t.host):return"youtube";case/twitch.tv/.test(t.host)&&window.location.protocol.includes("https"):return"twitch"}}(e);return(l=function(t,e){return t.includes(e)}(g,l)?"":l)&&n?((null===(s=t.settings.video)||void 0===s?void 0:s.max_width)&&(d=Math.min(t.settings.video.max_width,u)),a=a||t.settings.video&&t.settings.video.service_name||"kakao_tv",r(e,i,l,d,a)):o(e,i)},s=i(124);function u(t,e,i){var n=t.dom.create("p");n.innerHTML='<br data-mce-bogus="1">',t.dom.insertAfter(n,i),e.setStart(n,0),e.setEnd(n,0),t.selection.setRng(e)}function d(t,e,i){if(e){var n=e.getAttribute("href"),r=n.startsWith("http")?n:"http://"+n,o=t.dom.getParent(t.selection.getNode(),"body > *");if(t.dom.is(o,"table"))u(t,i,e);else{if(o.nextSibling&&"FIGURE"===o.nextSibling.nodeName&&o.nextSibling.getAttribute("data-ke-type").startsWith("opengraph")){var a=o.nextSibling.querySelector("a")||o.nextSibling;if(a&&a.getAttribute("data-source-url")===r)return void u(t,i,o)}g(t,r,e,i)}}}function g(t,e,i,n,r){i||(i=t.selection.getNode(),n=t.selection.getSel().getRangeAt(0));var o=t.dom,d=document.createElement("figure");d.setAttribute("contenteditable","false"),d.className="og-loading",d.textContent="불러오는 중입니다...",o.insertAfter(d,o.getParent(i,"body > *, body > div > *")),d.nextSibling||u(t,n,d);var g=Object(s.a)("video");t.settings.kOpengraph.fetch_handler(e,function(i){i.source_url&&""!==i.source_url||(i.source_url=e),0!==i.code?o.remove(d):(d.innerHTML=a(t,i,d,g,r),d.removeAttribute("class")),t.undoManager.add()},function(t){var e=(0,o.$)(".og-loading",o.getRoot());e.length>0&&o.remove(e)})}var l,c=function(t){var e,i=t.startContainer,n=t.startOffset;if("A"===i.nodeName&&(e=i),"#text"!==i.nodeName){var r=n===i.childNodes.length?i.lastChild:i.childNodes[n];if(!r)return;"A"===r.nodeName?e=r:r.previousSibling&&"A"===r.previousSibling.nodeName?e=r.previousSibling:r.previousSibling&&r.previousSibling.previousSibling&&"A"===r.previousSibling.previousSibling.nodeName&&(e=r.previousSibling.previousSibling)}else"A"===i.parentNode.nodeName&&(e=i.parentNode),1===i.textContent.length&&i.textContent[0].search(/[\s]/)>-1&&i.previousSibling&&"A"===i.previousSibling.nodeName&&(e=i.previousSibling);return e},p=function(){function t(t){this.parserCommandPrefix="GetHTMLByCDM_",this.CDMTypeName="opengraph",this.parserCommand=this.parserCommandPrefix+this.CDMTypeName,this.editor=t}return t.prototype.register=function(){var t=this;this.editor.addCommand(this.parserCommand,function(e){var i=e.htmlArray,n=e.item,r=t.getHTMLStringByCDM(n.attribute);i.push(r)})},t.prototype.getFigureNode=function(t){var e=document.createElement("figure");return e.setAttribute("contenteditable","false"),e.setAttribute("data-ke-type",this.CDMTypeName),e.setAttribute("data-og-title",t.title),t.desc&&e.setAttribute("data-og-description",t.desc),e.setAttribute("data-og-host",t.host),e.setAttribute("data-og-source-url",t.sourceUrl),t.image&&e.setAttribute("data-og-image",t.image),e.setAttribute("data-og-url",t.url),e.setAttribute("data-ke-align",t.align),e},t.prototype.getOpengraphContentsNode=function(t){var e=document.createElement("a");e.setAttribute("href",t.url),e.setAttribute("target","_blank"),e.setAttribute("data-source-url",t.sourceUrl);var i=document.createElement("div");i.setAttribute("class","og-image"),t.image&&i.setAttribute("style","background-image:url("+t.image+")");var n=document.createElement("div");return n.setAttribute("class","og-text"),n.appendChild(this.getOpengraphItem("og-title",t.title)),t.desc&&n.appendChild(this.getOpengraphItem("og-desc",t.desc)),n.appendChild(this.getOpengraphItem("og-host",t.host)),e.appendChild(i),e.appendChild(n),e},t.prototype.getOpengraphItem=function(t,e){var i=document.createElement("p");return i.setAttribute("class",t),i.innerText=e,i},t.prototype.getHTMLStringByCDM=function(t){var e=this.getFigureNode(t),i=this.getOpengraphContentsNode(t);return e.appendChild(i),e.outerHTML},t}(),h=function(){function t(t){this.editor=t}return t.prototype.getFigureNode=function(){var t=this.editor.selection.getNode(),e=this.editor.$(t).closest("figure[data-ke-type]");return e&&e[0]?e:null},t.prototype.alignFloat=function(t){var e=this.getFigureNode();e[0]&&e.attr("data-ke-align",t)},t.prototype.register=function(t,e){this.editor.addCommand(e,this.alignFloat.bind(this,t))},t}(),v=function(t,e){var i=function(e){var i=this,n=function(){var e=t.$(t.selection.getNode()).closest("figure").attr("data-ke-align");i.active(i.settings.activestate==e)};n(),t.on("nodeChange",function(t){n()})};"alignLeft"===e?t.addButton("opengraphAlignLeft",{title:"Align left",cmd:"opengraphAlignLeft",icon:"imagealignleft",activestate:"alignLeft",onpostrender:i}):"alignCenter"===e?t.addButton("opengraphAlignCenter",{title:"Align center",cmd:"opengraphAlignCenter",icon:"imagealigncenter",activestate:"alignCenter",onpostrender:i}):"alignRight"===e&&t.addButton("opengraphAlignRight",{title:"Align right",cmd:"opengraphAlignRight",icon:"imagealignright",activestate:"alignRight",onpostrender:i})};!function(t){t.alignLeft="opengraphAlignLeft",t.alignCenter="opengraphAlignCenter",t.alignRight="opengraphAlignRight"}(l||(l={}));var f=function(){function t(t){this.editor=t,this.toolbarButtonArray=[],this.toolbarString=t.settings.kOpengraph&&t.settings.kOpengraph.toolbar,this.toolbarString&&(this.toolbarArray=this.toolbarString.split(" "),this.AlignAction=new h(this.editor))}return t.prototype.add=function(t){this.toolbarButtonArray.push(t)},t.prototype.predicate=function(t){return this.editor.dom.is(t,'figure[data-ke-type="opengraph"]')},t.prototype.register=function(){var t=this;if(!this.toolbarString)return!1;this.toolbarArray.forEach(function(e,i){l[e]?(t.AlignAction.register(e,l[e]),v(t.editor,e),t.add(l[e])):"|"===e&&t.add("|")}),this.editor.addContextToolbar(this.predicate.bind(this),this.toolbarButtonArray.join(" "))},t}(),b=function(t){var e=new f(t);new p(t).register();t.addCommand("makeOpengraph",function(){var e=t.selection.getSel().getRangeAt(0),i=c(e);d(t,i,e)}),t.addCommand("makeOpengraphWithUrl",function(e){g(t,e)}),t.addCommand("makeOpengraphWithKakaoTvService",function(e,i){g(t,e,null,null,i)}),t.on("PreProcess",function(e){var i=(0,t.dom.$)(".og-loading",e.node);i.length>0&&t.dom.remove(i)}),t.on("keyDown",function(e){var i=t.dom.$;if(13===e.keyCode){var n=t.selection.getSel().getRangeAt(0),r=c(n);!r||i(r).closest("td")[0]||/^tel:/.test(r.getAttribute("href"))||(e.preventDefault(),d(t,r,n))}}),t.on("init",function(){e.register()})};window.tinymce.PluginManager.add("kOpengraph",b)}});